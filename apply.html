<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apply for Strategy Session | Delray.Services</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <script src="config.js"></script>
    <style>
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #020617 0%, #0f172a 100%);
        }

        .font-display {
            font-family: 'Playfair Display', serif;
        }

        .glass {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .step-indicator.active {
            background: #d4af37;
            color: #0f172a;
        }

        .step-indicator.complete {
            background: #10b981;
            color: white;
        }

        input:focus,
        select:focus,
        textarea:focus {
            border-color: #d4af37 !important;
            outline: none;
        }

        .file-upload:hover {
            border-color: #d4af37;
        }

        .value-card {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                box-shadow: 0 0 0 0 rgba(212, 175, 55, 0.3);
            }

            50% {
                box-shadow: 0 0 20px 5px rgba(212, 175, 55, 0.1);
            }
        }
    </style>
</head>

<body class="min-h-screen text-white p-4 md:p-8">

    <!-- Header -->
    <div class="max-w-4xl mx-auto mb-8 text-center">
        <div class="text-[10px] font-bold tracking-[0.3em] text-[#d4af37] uppercase mb-2">
            <i class="fas fa-shield-alt mr-2"></i>Verified Business Applications Only
        </div>
        <h1 class="text-3xl md:text-4xl font-display font-bold">
            Apply for a <span class="text-transparent bg-clip-text bg-gradient-to-r from-[#d4af37] to-white">Strategy
                Session</span>
        </h1>
        <p class="text-gray-400 mt-3 text-sm">Limited to 5 qualified businesses per month</p>
    </div>

    <!-- Progress Steps -->
    <div class="max-w-4xl mx-auto mb-8">
        <div class="flex justify-between items-center relative">
            <div class="absolute top-1/2 left-0 right-0 h-1 bg-gray-700 -translate-y-1/2"></div>
            <div class="absolute top-1/2 left-0 h-1 bg-[#d4af37] -translate-y-1/2 transition-all duration-500"
                id="progress-bar" style="width: 0%"></div>

            <div class="step-indicator active w-10 h-10 rounded-full flex items-center justify-center font-bold relative z-10"
                id="step-ind-1">1</div>
            <div class="step-indicator bg-gray-700 w-10 h-10 rounded-full flex items-center justify-center font-bold relative z-10"
                id="step-ind-2">2</div>
            <div class="step-indicator bg-gray-700 w-10 h-10 rounded-full flex items-center justify-center font-bold relative z-10"
                id="step-ind-3">3</div>
            <div class="step-indicator bg-gray-700 w-10 h-10 rounded-full flex items-center justify-center font-bold relative z-10"
                id="step-ind-4">4</div>
            <div class="step-indicator bg-gray-700 w-10 h-10 rounded-full flex items-center justify-center font-bold relative z-10"
                id="step-ind-5">5</div>
        </div>
        <div class="flex justify-between mt-2 text-[10px] text-gray-500 uppercase tracking-wider">
            <span>Business</span>
            <span>Verify</span>
            <span>Value</span>
            <span>Schedule</span>
            <span>Confirm</span>
        </div>
    </div>

    <!-- Application Form -->
    <div class="max-w-4xl mx-auto glass rounded-2xl p-8">

        <!-- STEP 1: Business Information -->
        <div id="step1" class="step-content">
            <h2 class="text-xl font-bold mb-6"><i class="fas fa-building text-[#d4af37] mr-3"></i>Tell Us About Your
                Business</h2>

            <div class="grid md:grid-cols-2 gap-6">
                <div>
                    <label class="block text-xs font-bold text-gray-400 uppercase mb-2">Legal Business Name *</label>
                    <input type="text" id="business-name" required
                        class="w-full p-4 bg-black/30 border border-gray-700 rounded-lg text-white"
                        placeholder="Acme Corporation LLC">
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-400 uppercase mb-2">Business Website *</label>
                    <input type="url" id="business-website" required
                        class="w-full p-4 bg-black/30 border border-gray-700 rounded-lg text-white"
                        placeholder="https://example.com">
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-400 uppercase mb-2">Industry *</label>
                    <select id="business-industry" required
                        class="w-full p-4 bg-black/30 border border-gray-700 rounded-lg text-white">
                        <option value="">Select Industry</option>
                        <option value="marine">Marine / Marina / Yachting</option>
                        <option value="real-estate">Real Estate / Hospitality</option>
                        <option value="tech">Technology / Data Centers</option>
                        <option value="finance">Finance / Investment</option>
                        <option value="healthcare">Healthcare / Wellness</option>
                        <option value="manufacturing">Manufacturing</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-400 uppercase mb-2">Annual Revenue *</label>
                    <select id="business-revenue" required
                        class="w-full p-4 bg-black/30 border border-gray-700 rounded-lg text-white">
                        <option value="">Select Range</option>
                        <option value="0-500k">$0 - $500K</option>
                        <option value="500k-1m">$500K - $1M</option>
                        <option value="1m-5m">$1M - $5M</option>
                        <option value="5m-10m">$5M - $10M</option>
                        <option value="10m+">$10M+</option>
                    </select>
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-400 uppercase mb-2">State of Incorporation *</label>
                    <select id="business-state" required
                        class="w-full p-4 bg-black/30 border border-gray-700 rounded-lg text-white">
                        <option value="">Select State</option>
                        <option value="FL">Florida</option>
                        <option value="CA">California</option>
                        <option value="TX">Texas</option>
                        <option value="NY">New York</option>
                        <option value="DE">Delaware</option>
                        <option value="other">Other State</option>
                    </select>
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-400 uppercase mb-2">Your Role *</label>
                    <select id="contact-role" required
                        class="w-full p-4 bg-black/30 border border-gray-700 rounded-lg text-white">
                        <option value="">Select Role</option>
                        <option value="ceo">CEO / Owner</option>
                        <option value="cfo">CFO / Finance</option>
                        <option value="coo">COO / Operations</option>
                        <option value="cto">CTO / Technology</option>
                        <option value="other">Other Executive</option>
                    </select>
                </div>
            </div>

            <div class="mt-8 flex justify-end">
                <button onclick="nextStep(2)"
                    class="px-8 py-4 bg-[#d4af37] text-[#0f172a] font-bold rounded-lg hover:bg-white transition">
                    Next: Verify Business <i class="fas fa-arrow-right ml-2"></i>
                </button>
            </div>
        </div>

        <!-- STEP 2: Business Verification -->
        <div id="step2" class="step-content hidden">
            <h2 class="text-xl font-bold mb-6"><i class="fas fa-shield-alt text-[#d4af37] mr-3"></i>Verify Your Business
            </h2>
            <p class="text-gray-400 text-sm mb-6">We work exclusively with verified, legitimate businesses. This helps
                us provide better service.</p>

            <div class="grid md:grid-cols-2 gap-6">
                <!-- Business License Upload -->
                <div class="md:col-span-2">
                    <label class="block text-xs font-bold text-gray-400 uppercase mb-2">Business License / Registration
                        *</label>
                    <div class="file-upload border-2 border-dashed border-gray-600 rounded-lg p-8 text-center cursor-pointer hover:border-[#d4af37] transition"
                        onclick="document.getElementById('license-file').click()">
                        <input type="file" id="license-file" accept="image/*,.pdf" class="hidden"
                            onchange="handleFileUpload(this, 'license')">
                        <div id="license-preview" class="hidden">
                            <i class="fas fa-check-circle text-4xl text-green-500 mb-2"></i>
                            <p class="text-green-400" id="license-filename">File uploaded</p>
                        </div>
                        <div id="license-placeholder">
                            <i class="fas fa-cloud-upload-alt text-4xl text-gray-500 mb-2"></i>
                            <p class="text-gray-400">Click to upload business license</p>
                            <p class="text-xs text-gray-500 mt-1">PNG, JPG, or PDF (max 5MB)</p>
                        </div>
                    </div>
                </div>

                <!-- Secretary of State Verification -->
                <div>
                    <label class="block text-xs font-bold text-gray-400 uppercase mb-2">Secretary of State Filing
                        Number</label>
                    <input type="text" id="sos-number"
                        class="w-full p-4 bg-black/30 border border-gray-700 rounded-lg text-white"
                        placeholder="e.g., P12345678">
                    <p class="text-xs text-gray-500 mt-1">Optional - helps speed up verification</p>
                </div>

                <div>
                    <label class="block text-xs font-bold text-gray-400 uppercase mb-2">EIN (Tax ID)</label>
                    <input type="text" id="ein-number"
                        class="w-full p-4 bg-black/30 border border-gray-700 rounded-lg text-white"
                        placeholder="XX-XXXXXXX">
                    <p class="text-xs text-gray-500 mt-1">Optional - for tax-advantaged strategies</p>
                </div>
            </div>

            <!-- Verification Status -->
            <div class="mt-6 p-4 bg-blue-500/10 border border-blue-500/30 rounded-lg" id="verification-status">
                <div class="flex items-center gap-3">
                    <i class="fas fa-info-circle text-blue-400"></i>
                    <div>
                        <p class="text-sm text-blue-300">Verification happens automatically after submission</p>
                        <p class="text-xs text-gray-400">We check Secretary of State records and match business name
                            with domain</p>
                    </div>
                </div>
            </div>

            <div class="mt-8 flex justify-between">
                <button onclick="nextStep(1)"
                    class="px-6 py-4 border border-gray-600 text-gray-400 rounded-lg hover:border-white hover:text-white transition">
                    <i class="fas fa-arrow-left mr-2"></i> Back
                </button>
                <button onclick="nextStep(3)"
                    class="px-8 py-4 bg-[#d4af37] text-[#0f172a] font-bold rounded-lg hover:bg-white transition">
                    Next: See Your Value <i class="fas fa-arrow-right ml-2"></i>
                </button>
            </div>
        </div>

        <!-- STEP 3: Value Calculator -->
        <div id="step3" class="step-content hidden">
            <h2 class="text-xl font-bold mb-6"><i class="fas fa-chart-line text-[#d4af37] mr-3"></i>Your Estimated Value
            </h2>

            <div class="grid md:grid-cols-2 gap-6">
                <!-- Value Inputs -->
                <div class="space-y-6">
                    <div>
                        <label class="block text-xs font-bold text-gray-400 uppercase mb-2">Monthly Operational
                            Spend</label>
                        <div class="relative">
                            <span class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400">$</span>
                            <input type="number" id="monthly-opex"
                                class="w-full p-4 pl-8 bg-black/30 border border-gray-700 rounded-lg text-white"
                                placeholder="50000" oninput="calculateValue()">
                        </div>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-400 uppercase mb-2">Hours Spent on Manual Tasks
                            (per week)</label>
                        <input type="number" id="manual-hours"
                            class="w-full p-4 bg-black/30 border border-gray-700 rounded-lg text-white" placeholder="20"
                            oninput="calculateValue()">
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-400 uppercase mb-2">Biggest Bottleneck</label>
                        <textarea id="bottleneck" rows="3"
                            class="w-full p-4 bg-black/30 border border-gray-700 rounded-lg text-white"
                            placeholder="Describe your biggest operational challenge..."></textarea>
                    </div>
                </div>

                <!-- Value Results -->
                <div
                    class="value-card bg-gradient-to-br from-[#d4af37]/20 to-[#d4af37]/5 border border-[#d4af37]/30 rounded-xl p-6">
                    <h3 class="text-lg font-bold text-[#d4af37] mb-4">Your Potential Savings</h3>

                    <div class="space-y-4">
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">AI Automation Savings (30%)</span>
                            <span class="text-2xl font-bold text-white" id="ai-savings">$15,000</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Time Recovered Monthly</span>
                            <span class="text-2xl font-bold text-white" id="time-savings">80 hrs</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Tax Strategy Savings (Est.)</span>
                            <span class="text-2xl font-bold text-white" id="tax-savings">$50,000</span>
                        </div>

                        <div class="border-t border-[#d4af37]/30 pt-4 mt-4">
                            <div class="flex justify-between items-center">
                                <span class="text-lg font-bold text-[#d4af37]">First Year Value</span>
                                <span class="text-3xl font-bold text-[#d4af37]" id="total-value">$230,000</span>
                            </div>
                        </div>
                    </div>

                    <div class="mt-6 p-3 bg-green-500/10 border border-green-500/30 rounded-lg">
                        <p class="text-xs text-green-300">
                            <i class="fas fa-hand-holding-heart mr-1"></i>
                            Give Back: <strong>$23,000</strong> to Healthy People, Water, or Animals
                        </p>
                    </div>
                </div>
            </div>

            <div class="mt-8 flex justify-between">
                <button onclick="nextStep(2)"
                    class="px-6 py-4 border border-gray-600 text-gray-400 rounded-lg hover:border-white hover:text-white transition">
                    <i class="fas fa-arrow-left mr-2"></i> Back
                </button>
                <button onclick="nextStep(4)"
                    class="px-8 py-4 bg-[#d4af37] text-[#0f172a] font-bold rounded-lg hover:bg-white transition">
                    Next: Schedule Call <i class="fas fa-arrow-right ml-2"></i>
                </button>
            </div>
        </div>

        <!-- STEP 4: Schedule & Contact -->
        <div id="step4" class="step-content hidden">
            <h2 class="text-xl font-bold mb-6"><i class="fas fa-calendar text-[#d4af37] mr-3"></i>Schedule Your Strategy
                Session</h2>

            <div class="grid md:grid-cols-2 gap-6">
                <div>
                    <label class="block text-xs font-bold text-gray-400 uppercase mb-2">Your Full Name *</label>
                    <input type="text" id="contact-name" required
                        class="w-full p-4 bg-black/30 border border-gray-700 rounded-lg text-white"
                        placeholder="John Smith">
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-400 uppercase mb-2">Email Address *</label>
                    <input type="email" id="contact-email" required
                        class="w-full p-4 bg-black/30 border border-gray-700 rounded-lg text-white"
                        placeholder="john@company.com">
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-400 uppercase mb-2">Phone Number *</label>
                    <input type="tel" id="contact-phone" required
                        class="w-full p-4 bg-black/30 border border-gray-700 rounded-lg text-white"
                        placeholder="+1 (555) 123-4567">
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-400 uppercase mb-2">Preferred Time</label>
                    <select id="preferred-time"
                        class="w-full p-4 bg-black/30 border border-gray-700 rounded-lg text-white">
                        <option value="morning">Morning (9AM - 12PM EST)</option>
                        <option value="afternoon">Afternoon (12PM - 5PM EST)</option>
                        <option value="evening">Evening (5PM - 7PM EST)</option>
                    </select>
                </div>
            </div>

            <!-- Booking Unavailable Option -->
            <div class="mt-6 p-4 bg-orange-500/10 border border-orange-500/30 rounded-lg">
                <label class="flex items-start gap-3 cursor-pointer">
                    <input type="checkbox" id="partner-referral" class="mt-1 w-5 h-5 accent-[#d4af37]"
                        onchange="togglePartnerOption()">
                    <div>
                        <p class="font-bold text-orange-300">Delray's calendar is full? Connect me with a qualified
                            partner</p>
                        <p class="text-xs text-gray-400 mt-1">By checking this, you agree to sign an NDA and we may
                            forward your info to a vetted partner consultant.</p>
                    </div>
                </label>
            </div>

            <!-- NDA Agreement (shown when partner referral checked) -->
            <div id="nda-section" class="mt-4 p-4 bg-purple-500/10 border border-purple-500/30 rounded-lg hidden">
                <h4 class="font-bold text-purple-300 mb-3"><i class="fas fa-file-signature mr-2"></i>Non-Disclosure
                    Agreement</h4>
                <div class="bg-black/30 p-4 rounded-lg max-h-40 overflow-y-auto text-xs text-gray-400 mb-4">
                    <p><strong>MUTUAL NON-DISCLOSURE AGREEMENT</strong></p>
                    <p class="mt-2">This Agreement is entered into as of the date of electronic signature between the
                        undersigned party ("Disclosing Party") and Delray Wannemacher / Delray.Services ("Receiving
                        Party").</p>
                    <p class="mt-2">1. CONFIDENTIAL INFORMATION: All business information, strategies, financial data,
                        and proprietary methods shared during the consultation process.</p>
                    <p class="mt-2">2. OBLIGATIONS: Both parties agree to maintain strict confidentiality and not
                        disclose information to third parties without written consent.</p>
                    <p class="mt-2 text-gold">3. TERM: This agreement remains in effect for 3 years from the date of
                        signing.</p>
                    <p class="mt-2">4. PARTNER DISCLOSURE: If Disclosing Party opts for partner referral, information
                        may be shared with vetted, NDA-bound partner consultants.</p>
                </div>
                <label class="flex items-center gap-3 cursor-pointer">
                    <input type="checkbox" id="nda-agree" class="w-5 h-5 accent-[#d4af37]">
                    <span class="text-sm text-purple-300">I agree to the Non-Disclosure Agreement</span>
                </label>
            </div>

            <div class="mt-8 flex justify-between">
                <button onclick="nextStep(3)"
                    class="px-6 py-4 border border-gray-600 text-gray-400 rounded-lg hover:border-white hover:text-white transition">
                    <i class="fas fa-arrow-left mr-2"></i> Back
                </button>
                <button onclick="nextStep(5)"
                    class="px-8 py-4 bg-[#d4af37] text-[#0f172a] font-bold rounded-lg hover:bg-white transition">
                    Next: Review & Submit <i class="fas fa-arrow-right ml-2"></i>
                </button>
            </div>
        </div>

        <!-- STEP 5: Review & Submit -->
        <div id="step5" class="step-content hidden">
            <h2 class="text-xl font-bold mb-6"><i class="fas fa-check-circle text-[#d4af37] mr-3"></i>Review Your
                Application</h2>

            <div class="space-y-6">
                <!-- Summary Cards -->
                <div class="grid md:grid-cols-3 gap-4">
                    <div class="bg-black/30 p-4 rounded-lg">
                        <p class="text-xs text-gray-400 uppercase">Business</p>
                        <p class="font-bold text-white" id="review-business">--</p>
                    </div>
                    <div class="bg-black/30 p-4 rounded-lg">
                        <p class="text-xs text-gray-400 uppercase">Industry</p>
                        <p class="font-bold text-white" id="review-industry">--</p>
                    </div>
                    <div class="bg-black/30 p-4 rounded-lg">
                        <p class="text-xs text-gray-400 uppercase">Est. First Year Value</p>
                        <p class="font-bold text-[#d4af37]" id="review-value">--</p>
                    </div>
                </div>

                <!-- Agreements -->
                <div class="space-y-4">
                    <label
                        class="flex items-start gap-3 cursor-pointer p-4 bg-[#d4af37]/10 border border-[#d4af37]/30 rounded-lg">
                        <input type="checkbox" id="agree-challenge" required class="mt-1 w-5 h-5 accent-[#d4af37]">
                        <div>
                            <p class="font-bold text-[#d4af37]">I Accept the Give Back Challenge</p>
                            <p class="text-xs text-gray-400">I pledge to donate 10% of value created to Healthy People,
                                Healthy Water, or Healthy Animals initiatives.</p>
                        </div>
                    </label>

                    <label
                        class="flex items-start gap-3 cursor-pointer p-4 bg-black/30 border border-gray-700 rounded-lg">
                        <input type="checkbox" id="agree-terms" required class="mt-1 w-5 h-5 accent-[#d4af37]">
                        <div>
                            <p class="font-bold text-white">I Confirm Information is Accurate</p>
                            <p class="text-xs text-gray-400">I verify that all business information provided is accurate
                                and I am authorized to represent this business.</p>
                        </div>
                    </label>
                </div>

                <!-- Slots Remaining -->
                <div class="p-4 bg-red-500/10 border border-red-500/30 rounded-lg text-center">
                    <p class="text-red-300">
                        <i class="fas fa-fire mr-2"></i>
                        Only <strong id="slots-remaining">3</strong> strategy session slots remaining this month
                    </p>
                </div>
            </div>

            <div class="mt-8 flex justify-between">
                <button onclick="nextStep(4)"
                    class="px-6 py-4 border border-gray-600 text-gray-400 rounded-lg hover:border-white hover:text-white transition">
                    <i class="fas fa-arrow-left mr-2"></i> Back
                </button>
                <button onclick="submitApplication()" id="submit-btn"
                    class="px-8 py-4 bg-gradient-to-r from-[#d4af37] to-[#f59e0b] text-[#0f172a] font-bold rounded-lg hover:opacity-90 transition text-lg">
                    <i class="fas fa-paper-plane mr-2"></i> Submit Application
                </button>
            </div>
        </div>

        <!-- SUCCESS STATE -->
        <div id="step-success" class="step-content hidden text-center py-12">
            <div class="text-6xl mb-4">ðŸŽ‰</div>
            <h2 class="text-3xl font-bold text-[#d4af37] mb-4">Application Submitted!</h2>
            <p class="text-gray-400 mb-8 max-w-md mx-auto">
                We're verifying your business information. You'll receive an email within 24 hours with next steps.
            </p>

            <div class="bg-green-500/10 border border-green-500/30 rounded-lg p-6 max-w-md mx-auto mb-8">
                <h3 class="font-bold text-green-300 mb-2">What Happens Next:</h3>
                <ol class="text-left text-sm text-gray-400 space-y-2">
                    <li>1. We verify your business (1-24 hours)</li>
                    <li>2. You receive calendar link via email</li>
                    <li>3. Book your 15-min strategy session</li>
                    <li>4. We design your custom AI & capital strategy</li>
                </ol>
            </div>

            <p class="text-xs text-gray-500">
                Application ID: <span id="app-id" class="font-mono">DW-XXXXX</span>
            </p>
        </div>
    </div>

    <!-- Trust Footer -->
    <div class="max-w-4xl mx-auto mt-8 text-center text-xs text-gray-500">
        <p><i class="fas fa-lock mr-1"></i> 256-bit SSL Encrypted | Your data is secure</p>
        <p class="mt-2">Delray.Services | Give Back Challenge | Â© 2026</p>
    </div>

    <script>
        let currentStep = 1;
        let applicationData = {};

        function nextStep(step) {
            // Validate current step before proceeding
            if (step > currentStep && !validateStep(currentStep)) return;

            // Hide all steps
            document.querySelectorAll('.step-content').forEach(el => el.classList.add('hidden'));

            // Show target step
            document.getElementById('step' + step).classList.remove('hidden');

            // Update indicators
            for (let i = 1; i <= 5; i++) {
                const ind = document.getElementById('step-ind-' + i);
                ind.classList.remove('active', 'complete');
                if (i < step) ind.classList.add('complete');
                else if (i === step) ind.classList.add('active');
            }

            // Update progress bar
            document.getElementById('progress-bar').style.width = ((step - 1) / 4 * 100) + '%';

            // Update review on step 5
            if (step === 5) updateReview();

            currentStep = step;
        }

        function validateStep(step) {
            if (step === 1) {
                const required = ['business-name', 'business-website', 'business-industry', 'business-revenue', 'business-state', 'contact-role'];
                for (const id of required) {
                    if (!document.getElementById(id).value) {
                        alert('Please fill in all required fields');
                        return false;
                    }
                }
            }
            if (step === 4) {
                const required = ['contact-name', 'contact-email', 'contact-phone'];
                for (const id of required) {
                    if (!document.getElementById(id).value) {
                        alert('Please fill in all contact information');
                        return false;
                    }
                }
            }
            return true;
        }

        function handleFileUpload(input, type) {
            const file = input.files[0];
            if (file) {
                document.getElementById(type + '-placeholder').classList.add('hidden');
                document.getElementById(type + '-preview').classList.remove('hidden');
                document.getElementById(type + '-filename').textContent = file.name;
                applicationData[type + 'File'] = file;
            }
        }

        function togglePartnerOption() {
            const checked = document.getElementById('partner-referral').checked;
            document.getElementById('nda-section').classList.toggle('hidden', !checked);
        }

        function calculateValue() {
            const opex = parseFloat(document.getElementById('monthly-opex').value) || 50000;
            const hours = parseFloat(document.getElementById('manual-hours').value) || 20;

            const aiSavings = Math.round(opex * 0.3);
            const timeSavings = hours * 4; // monthly
            const taxSavings = Math.round(opex * 1.2); // estimated annual
            const totalValue = (aiSavings * 12) + (timeSavings * 50) + taxSavings;

            document.getElementById('ai-savings').textContent = '$' + aiSavings.toLocaleString() + '/mo';
            document.getElementById('time-savings').textContent = timeSavings + ' hrs/mo';
            document.getElementById('tax-savings').textContent = '$' + taxSavings.toLocaleString();
            document.getElementById('total-value').textContent = '$' + totalValue.toLocaleString();

            applicationData.estimatedValue = totalValue;
        }

        function updateReview() {
            document.getElementById('review-business').textContent = document.getElementById('business-name').value || '--';
            document.getElementById('review-industry').textContent = document.getElementById('business-industry').value || '--';
            document.getElementById('review-value').textContent = document.getElementById('total-value').textContent || '--';

            // Random slots remaining for urgency
            document.getElementById('slots-remaining').textContent = Math.floor(Math.random() * 3) + 2;
        }

        async function submitApplication() {
            const btn = document.getElementById('submit-btn');

            if (!document.getElementById('agree-challenge').checked || !document.getElementById('agree-terms').checked) {
                alert('Please accept both agreements to continue');
                return;
            }

            btn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Submitting...';
            btn.disabled = true;

            // Gather all data
            applicationData = {
                ...applicationData,
                businessName: document.getElementById('business-name').value,
                website: document.getElementById('business-website').value,
                industry: document.getElementById('business-industry').value,
                revenue: document.getElementById('business-revenue').value,
                state: document.getElementById('business-state').value,
                role: document.getElementById('contact-role').value,
                sosNumber: document.getElementById('sos-number').value,
                einNumber: document.getElementById('ein-number').value,
                bottleneck: document.getElementById('bottleneck').value,
                contactName: document.getElementById('contact-name').value,
                contactEmail: document.getElementById('contact-email').value,
                contactPhone: document.getElementById('contact-phone').value,
                preferredTime: document.getElementById('preferred-time').value,
                partnerReferral: document.getElementById('partner-referral').checked,
                ndaAgreed: document.getElementById('nda-agree')?.checked || false,
                giveBackPledge: true,
                submittedAt: new Date().toISOString()
            };

            // Generate application ID
            const appId = 'DW-' + Date.now().toString(36).toUpperCase();
            applicationData.applicationId = appId;

            // Submit to Bitrix24
            const bitrixUrl = typeof DELRAY_CONFIG !== 'undefined'
                ? DELRAY_CONFIG.bitrix.webhookUrl + DELRAY_CONFIG.bitrix.endpoints.addLead
                : 'https://b24-9o23fs.bitrix24.com/rest/1/s1u82w02apaja3fi/crm.lead.add.json';

            // Save to LocalStorage for God Mode Live Demo
            try {
                const existingLeads = JSON.parse(localStorage.getItem('DELRAY_LEADS') || '[]');
                existingLeads.unshift({
                    ...applicationData,
                    status: 'NEW',
                    source: 'Verified Application'
                });
                localStorage.setItem('DELRAY_LEADS', JSON.stringify(existingLeads));

                // Update specific stats
                const stats = JSON.parse(localStorage.getItem('DELRAY_STATS') || '{"leads": 12, "value": 230000}');
                stats.leads++;
                stats.value += (applicationData.estimatedValue || 0);
                localStorage.setItem('DELRAY_STATS', JSON.stringify(stats));
            } catch (e) { console.log('God Mode Sync Error:', e); }

            try {
                await fetch(bitrixUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        fields: {
                            TITLE: `VERIFIED APP: ${applicationData.businessName}`,
                            NAME: applicationData.contactName,
                            EMAIL: [{ VALUE: applicationData.contactEmail, VALUE_TYPE: 'WORK' }],
                            PHONE: [{ VALUE: applicationData.contactPhone, VALUE_TYPE: 'WORK' }],
                            COMPANY_TITLE: applicationData.businessName,
                            COMMENTS: `
APPLICATION ID: ${appId}
INDUSTRY: ${applicationData.industry}
REVENUE: ${applicationData.revenue}
STATE: ${applicationData.state}
ROLE: ${applicationData.role}
WEBSITE: ${applicationData.website}
SOS #: ${applicationData.sosNumber || 'Not provided'}
EIN: ${applicationData.einNumber || 'Not provided'}
BOTTLENECK: ${applicationData.bottleneck}
EST. VALUE: $${applicationData.estimatedValue?.toLocaleString() || 'TBD'}
PARTNER REFERRAL: ${applicationData.partnerReferral ? 'YES (NDA Signed)' : 'NO'}
GIVE BACK PLEDGE: ACCEPTED
                            `.trim(),
                            SOURCE_ID: 'WEB',
                            STATUS_ID: 'NEW'
                        }
                    })
                });
            } catch (err) { console.log('Submit error:', err); }

            // Show success
            document.querySelectorAll('.step-content').forEach(el => el.classList.add('hidden'));
            document.getElementById('step-success').classList.remove('hidden');
            document.getElementById('app-id').textContent = appId;

            // Update progress bar to full
            document.getElementById('progress-bar').style.width = '100%';
            for (let i = 1; i <= 5; i++) {
                document.getElementById('step-ind-' + i).classList.remove('active');
                document.getElementById('step-ind-' + i).classList.add('complete');
            }
        }

        // Initialize
        calculateValue();
    </script>
</body>

</html>